{{ id }}:
  provider: {{ values['provider'] }}
  size: {{ values['size'] }}
  image: {{ values['image'] }}
  ssh_username: {{ values['ssh_username'] }}
  {% if variable is defined %}
  subnetid: {{ values['subnetid'] }}
  {% endif %}
  securitygroupid:
  {% for val in values['securitygroupid'] %}
    - {{ val }}
  {% endfor %}

  minion:
    master: {{ grains['fqdn_ip4'][0] }}
    {% if values['minion'] is defined %}
    {% if values['minion']['grains'] is defined %}
    grains:
      {% if values['minion']['grains']['roles'] is defined %}
      roles:
        {% for val in values['minion']['grains']['roles'] %}
        - {{ val }}
        {% endfor %}
      {% endif %}
    {% endif %}
    {% endif %}
